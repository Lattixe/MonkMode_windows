<Window x:Class="MonkMode.Views.FocusWorkspaceWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Focus Workspace"
        WindowStyle="None"
        AllowsTransparency="False"
        Background="#09090B"
        WindowState="Maximized"
        ResizeMode="NoResize"
        Topmost="False"
        ShowInTaskbar="False"
        PreviewKeyDown="Window_PreviewKeyDown">

    <Window.Resources>
        <Storyboard x:Key="PulseAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="LiveDot"
                             Storyboard.TargetProperty="Opacity"
                             From="1" To="0.3" Duration="0:0:1.2"
                             AutoReverse="True">
                <DoubleAnimation.EasingFunction>
                    <SineEase EasingMode="EaseInOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="48"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Control Bar - Always accessible -->
        <Border Grid.Row="0" 
                Background="#0F0F12"
                BorderBrush="#1F1F23"
                BorderThickness="0,0,0,1"
                MouseLeftButtonDown="ControlBar_MouseLeftButtonDown">
            <Grid Margin="16,0">
                <!-- Timer - Absolutely centered (overlay on top of everything) -->
                <TextBlock x:Name="TimerText"
                           Text="25:00"
                           Foreground="#FAFAFA"
                           FontSize="20"
                           FontWeight="SemiBold"
                           FontFamily="Cascadia Code, Consolas"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           IsHitTestVisible="False"/>
                
                <!-- Left and Right content panels -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Live indicator + Task (Left) -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <Ellipse x:Name="LiveDot"
                                 Width="8" Height="8"
                                 Fill="#EF4444"
                                 Margin="0,0,12,0"/>
                        <TextBlock x:Name="TaskNameText"
                                   Text="Focus Session"
                                   Foreground="#FAFAFA"
                                   FontSize="14"
                                   FontWeight="Medium"
                                   VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Buttons (Right) -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <!-- Extend button -->
                        <Button x:Name="ExtendButton"
                                Cursor="Hand"
                                Click="ExtendButton_Click"
                                PreviewMouseLeftButtonDown="ExtendButton_PreviewClick"
                                Margin="0,0,8,0"
                                Focusable="True">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="border" 
                                            Background="#1A1A1E" 
                                            CornerRadius="4" 
                                            Padding="12,6">
                                        <TextBlock Text="+5 min" 
                                                   Foreground="#71717A" 
                                                   FontSize="13"
                                                   x:Name="text"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#27272A"/>
                                            <Setter TargetName="text" Property="Foreground" Value="#FAFAFA"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#3F3F46"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>

                        <!-- Add windows button -->
                        <Button x:Name="WindowsButton"
                                Cursor="Hand"
                                Click="WindowsButton_Click"
                                PreviewMouseLeftButtonDown="WindowsButton_PreviewClick"
                                ToolTip="Add more windows to workspace"
                                Margin="0,0,8,0"
                                Focusable="True">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="border" 
                                            Background="#1A1A1E" 
                                            CornerRadius="4" 
                                            Padding="12,6">
                                        <TextBlock Text="+ Add Windows" 
                                                   Foreground="#71717A" 
                                                   FontSize="13"
                                                   x:Name="text"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#27272A"/>
                                            <Setter TargetName="text" Property="Foreground" Value="#FAFAFA"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#3F3F46"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                        
                        <!-- End session button - subtle grey X -->
                        <Button x:Name="EndButton"
                                Width="32" Height="32"
                                Cursor="Hand"
                                Click="EndButton_Click"
                                PreviewMouseLeftButtonDown="EndButton_PreviewClick"
                                ToolTip="End focus session (Esc)"
                                Focusable="True">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="border"
                                            Background="#27272A"
                                            CornerRadius="6"
                                            Width="32" Height="32">
                                        <TextBlock Text="✕" 
                                                   Foreground="#A1A1AA"
                                                   FontSize="14"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   x:Name="text"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#3F3F46"/>
                                            <Setter TargetName="text" Property="Foreground" Value="#FAFAFA"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#52525B"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>

        <!-- Workspace area - where windows appear -->
        <Grid Grid.Row="1" x:Name="WorkspaceArea" 
              MouseLeftButtonDown="WorkspaceArea_MouseLeftButtonDown"
              Background="Transparent">
            <!-- This is intentionally empty - selected windows float on top -->
            
            <!-- Centered hint when no windows visible -->
            <StackPanel x:Name="HintPanel"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Opacity="0.5">
                <TextBlock Text="Your focus workspace"
                           Foreground="#52525B"
                           FontSize="24"
                           FontWeight="Light"
                           HorizontalAlignment="Center"/>
                <TextBlock Text="Selected windows will appear here"
                           Foreground="#3F3F46"
                           FontSize="14"
                           HorizontalAlignment="Center"
                           Margin="0,8,0,0"/>
                <TextBlock Text="Press ⊞ Windows in the bar above to bring them forward"
                           Foreground="#3F3F46"
                           FontSize="12"
                           HorizontalAlignment="Center"
                           Margin="0,4,0,0"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
